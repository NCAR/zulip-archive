<html>
<head><meta charset="utf-8"><title>s3-API · DECS · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://127.0.0.1:4000/html/stream/25-DECS/index.html">DECS</a></h2>
<h3>Topic: <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html">s3-API</a></h3>

<hr>

<base href="https://zulip2.cloud.ucar.edu">

<head><link href="http://127.0.0.1:4000/style.css" rel="stylesheet"></head>

<a name="3738"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/3738" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#3738">(Mar 18 2020 at 17:30)</a>:</h4>
<p>Welcome to S3 discussion</p>



<a name="4858"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4858" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4858">(Mar 25 2020 at 16:52)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> is there anything we need to do to prepare for the S3 demo tomorrow afternoon?</p>



<a name="4860"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4860" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4860">(Mar 25 2020 at 16:52)</a>:</h4>
<p>I will work on uploading the package to <a href="http://pypi.org" target="_blank" title="http://pypi.org">pypi.org</a> today</p>



<a name="4866"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4866" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4866">(Mar 25 2020 at 17:02)</a>:</h4>
<p>I don't think so, but I'm not sure what's important to show. Just go through the functionality?</p>



<a name="4867"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4867" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4867">(Mar 25 2020 at 17:03)</a>:</h4>
<p>Yes, I think that's all we need to do at this point</p>



<a name="4868"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4868" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4868">(Mar 25 2020 at 17:04)</a>:</h4>
<p>OK, sounds good. I'll maybe write a jupyter notebook that shells out commands. Alos, Since Sage is big into java, I might do some of sort of java use case. Might be overkill though. <br>
We'll see what makes sense after the DECS meeting tomorrow.</p>



<a name="4869"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4869" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4869">(Mar 25 2020 at 17:24)</a>:</h4>
<p>Sounds good.  The package is now available from <a href="http://pypi.org" target="_blank" title="http://pypi.org">pypi.org</a> at <a href="https://pypi.org/project/ncar-rda-s3/" target="_blank" title="https://pypi.org/project/ncar-rda-s3/">https://pypi.org/project/ncar-rda-s3/</a>.  I have installed it on casper and copied it to /glade/u/home/rdadata/lib/python/site-packages.  You will need to include this in your python sys.path to import it.</p>



<a name="4871"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/4871" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#4871">(Mar 25 2020 at 17:29)</a>:</h4>
<p>It is also available on the EIO VMs.  Invoke python with 'python3', then 'import rda_s3'.</p>



<a name="5127"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5127" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5127">(Mar 26 2020 at 15:45)</a>:</h4>
<p><span class="user-mention" data-user-id="55">@Tom Cram</span> I'm wrapping up a jupyter notebook. Did you want to talk about installation/requirements? It seems like that's the gap right now.</p>



<a name="5134"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5134" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5134">(Mar 26 2020 at 16:05)</a>:</h4>
<p>Sure, no problem</p>



<a name="5150"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5150" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Doug Schuster <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5150">(Mar 26 2020 at 17:24)</a>:</h4>
<p><span class="user-mention" data-user-id="55">@Tom Cram</span> I added a symlink from /glade/u/home/rdadata/lib/python/site-packages/rda_s3/rda_s3.py to /glade/u/home/rdadata/bin.  As we discussed in the group meeting, please send out the user environment configuration requirements to success fully run this on rda-data or casper.  Thx!</p>



<a name="5151"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5151" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5151">(Mar 26 2020 at 17:27)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="5168"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5168" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5168">(Mar 26 2020 at 17:53)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> I'm going to change the Python interpreter in rda_s3.py to /usr/bin/env python3.  It's currently failing on the VMs because python2 is the default on those machines.</p>



<a name="5275"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5275" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5275">(Mar 26 2020 at 22:04)</a>:</h4>
<p>Interesting about TDS accessing that NetCDF file just fine. Did anyone catch how Sean was able to do range requests on the netcdf file on his emulated object store? Did his object metadata include the byte ranges of data?</p>



<a name="5291"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5291" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5291">(Mar 26 2020 at 22:39)</a>:</h4>
<p>I wasn't following closely enough to catch it.  He did that very quickly.</p>



<a name="5347"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5347" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Doug Schuster <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5347">(Mar 27 2020 at 15:46)</a>:</h4>
<p>I think he gets the byte offset info from the NetCDF file metadata, and might create a separate index file from that?  I don’t think it’s in the object metadata, but I’d think that’d be a viable option. Maybe check in with Sean on the details of his workflow.</p>



<a name="5381"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5381" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Doug Schuster <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5381">(Mar 27 2020 at 18:25)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> <a href="https://github.com/Unidata/netcdf-java/blob/master/cdm/s3/src/main/java/ucar/unidata/io/s3/S3RandomAccessFile.java" target="_blank" title="https://github.com/Unidata/netcdf-java/blob/master/cdm/s3/src/main/java/ucar/unidata/io/s3/S3RandomAccessFile.java">https://github.com/Unidata/netcdf-java/blob/master/cdm/s3/src/main/java/ucar/unidata/io/s3/S3RandomAccessFile.java</a><br/>
<a href="https://github.com/Unidata/netcdf-java/blob/master/cdm/s3/src/test/java/ucar/unidata/io/s3/TestS3Read.java" target="_blank" title="https://github.com/Unidata/netcdf-java/blob/master/cdm/s3/src/test/java/ucar/unidata/io/s3/TestS3Read.java">https://github.com/Unidata/netcdf-java/blob/master/cdm/s3/src/test/java/ucar/unidata/io/s3/TestS3Read.java</a></p>



<a name="5387"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5387" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5387">(Mar 27 2020 at 19:24)</a>:</h4>
<p>(deleted)</p>



<a name="5398"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5398" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5398">(Mar 27 2020 at 20:02)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> I'm getting AttributeError when I try to use rda_s3 within a Python session:</p>
<blockquote>
<blockquote>
<blockquote>
<p>import rda_s3 as rs<br/>
buckets = rs.list_buckets()<br/>
Traceback (most recent call last):<br/>
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/>
AttributeError: module 'rda_s3' has no attribute 'list_buckets'</p>
</blockquote>
</blockquote>
</blockquote>



<a name="5402"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5402" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5402">(Mar 27 2020 at 20:22)</a>:</h4>
<p>Found the problem.  'import rda_s3' only imports the package, not the module 'rda_s3.py'.  So we currently need to import it as:<br>
from rda_s3 import rda_s3<br>
buckets = rda_s3.list_buckets()</p>



<a name="5403"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5403" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5403">(Mar 27 2020 at 20:22)</a>:</h4>
<p>Hmm, Could rda_s3 be the directory instead of the file</p>



<a name="5404"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5404" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5404">(Mar 27 2020 at 20:23)</a>:</h4>
<p>I'll create an issue and get this sorted out.  Might be as simple as adding a line to __init__.py</p>



<a name="5405"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5405" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5405">(Mar 27 2020 at 20:23)</a>:</h4>
<p>I tried something similar a while ago and it didn't work as expected</p>



<a name="5406"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5406" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5406">(Mar 27 2020 at 20:24)</a>:</h4>
<p>actually, could putting an "from rda_s3 import *" work?</p>



<a name="5407"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5407" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5407">(Mar 27 2020 at 20:24)</a>:</h4>
<p>I wonder how the import in your Jupyter notebook is working though.  It shouldn't based on my error</p>



<a name="5408"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5408" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5408">(Mar 27 2020 at 20:24)</a>:</h4>
<p>No, I tried that and it didn't work</p>



<a name="5410"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5410" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5410">(Mar 27 2020 at 20:25)</a>:</h4>
<p>Oh, i mean in the __init__.py. I was executing the notebook in the same directory as the file, so i think it was grabbing the script itself.</p>



<a name="5411"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5411" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5411">(Mar 27 2020 at 20:28)</a>:</h4>
<p>Nevermind, putting 'from rda_s3 import *' in the __init__.py doesn't work</p>



<a name="5413"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5413" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5413">(Mar 27 2020 at 20:31)</a>:</h4>
<p>I think I can add 'from . import rda_s3' to the __init__.py file.  See <a href="https://stackoverflow.com/questions/47323411/attributeerror-module-object-has-no-attribute-xxxx" target="_blank" title="https://stackoverflow.com/questions/47323411/attributeerror-module-object-has-no-attribute-xxxx">https://stackoverflow.com/questions/47323411/attributeerror-module-object-has-no-attribute-xxxx</a></p>



<a name="5858"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5858" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5858">(Apr 02 2020 at 20:47)</a>:</h4>
<p>Github is slow this afternoon.  Unresponsive at times.</p>



<a name="5859"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5859" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5859">(Apr 02 2020 at 20:50)</a>:</h4>
<p><a href="/user_uploads/2/I3LLRzhB7S2qn-qa26e5-mqQ/Screen-Shot-2020-04-02-at-2.49.48-PM.png" target="_blank" title="Screen-Shot-2020-04-02-at-2.49.48-PM.png">Screen-Shot-2020-04-02-at-2.49.48-PM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/2/I3LLRzhB7S2qn-qa26e5-mqQ/Screen-Shot-2020-04-02-at-2.49.48-PM.png" target="_blank" title="Screen-Shot-2020-04-02-at-2.49.48-PM.png"><img src="/user_uploads/2/I3LLRzhB7S2qn-qa26e5-mqQ/Screen-Shot-2020-04-02-at-2.49.48-PM.png"></a></div>



<a name="5860"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5860" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5860">(Apr 02 2020 at 20:51)</a>:</h4>
<p>the dreaded rainbow unicorn!</p>



<a name="5864"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5864" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5864">(Apr 02 2020 at 21:50)</a>:</h4>
<p>pip install now working on isd-s3:<br>
<a href="https://pypi.org/project/ncar-isd-s3/" target="_blank" title="https://pypi.org/project/ncar-isd-s3/">https://pypi.org/project/ncar-isd-s3/</a></p>



<a name="5865"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5865" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5865">(Apr 02 2020 at 21:51)</a>:</h4>
<p>Module can be imported as:</p>
<blockquote>
<blockquote>
<blockquote>
<p>from isd_s3 import isd_s3<br>
isd_s3.list_buckets()</p>
</blockquote>
</blockquote>
</blockquote>



<a name="5866"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5866" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5866">(Apr 02 2020 at 21:51)</a>:</h4>
<p>Another method:</p>
<blockquote>
<blockquote>
<blockquote>
<p>from isd_s3 import isd_s3 as rs<br>
rs.list_buckets()</p>
</blockquote>
</blockquote>
</blockquote>



<a name="5867"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5867" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5867">(Apr 02 2020 at 21:53)</a>:</h4>
<p>Yet another method:</p>
<blockquote>
<blockquote>
<blockquote>
<p>import isd_s3.isd_s3 as rs<br>
rs.list_buckets()</p>
</blockquote>
</blockquote>
</blockquote>



<a name="5993"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/5993" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Doug Schuster <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#5993">(Apr 06 2020 at 15:14)</a>:</h4>
<p>Great!</p>



<a name="6104"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6104" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6104">(Apr 07 2020 at 17:36)</a>:</h4>
<p>@riley I'll go ahead and create a branch for this issue and fix it: <a href="https://github.com/NCAR/isd-s3/issues/22" target="_blank" title="https://github.com/NCAR/isd-s3/issues/22">https://github.com/NCAR/isd-s3/issues/22</a></p>



<a name="6202"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6202" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6202">(Apr 07 2020 at 21:02)</a>:</h4>
<p>Since we're generalizing this for ISD and broader CISL use, I think we should have a separate configuration file for RDA specific config info, e.g. S3_URL, default_bucket, AWS credentials.  I'm running into this issue by configuring the logging handler ... can't just put this configuration inside the main program, it should be imported instead.  I'll set something up for logging and test it out.  We can work on moving the other config info after logging works.  Simple config example: <a href="https://martin-thoma.com/configuration-files-in-python/#python-configuration-file" target="_blank" title="https://martin-thoma.com/configuration-files-in-python/#python-configuration-file">https://martin-thoma.com/configuration-files-in-python/#python-configuration-file</a></p>



<a name="6203"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6203" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6203">(Apr 07 2020 at 21:03)</a>:</h4>
<p>And the *config.py file would be included in .gitignore, since it applies only to us</p>



<a name="6380"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6380" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6380">(Apr 09 2020 at 21:52)</a>:</h4>
<p>Logging is now working.  I ran a pull request and deleted the log-test branch.  Log messages are written to /glade/u/home/rdadata/dssdb/log/isd-s3.log and debug mode, if specified, writes to isd-s3.dbg.</p>



<a name="6381"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6381" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6381">(Apr 09 2020 at 21:54)</a>:</h4>
<p>We will need to pull the function configure_log() out of the main code and put it into a new python wrapper since it's specific to the RDA use case.  This could be done in coordination with abstracting out the other RDA specific stuff.</p>



<a name="6383"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6383" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6383">(Apr 09 2020 at 22:14)</a>:</h4>
<p>The logging object in the code is named 'logger'.  Some example log messages that can be added to the code:</p>
<div class="codehilite"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;This is an info message&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;This is a debug message&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This is a warning message&quot;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;This is an error message&quot;</span><span class="p">)</span>
</pre></div>



<a name="6950"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6950" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6950">(Apr 21 2020 at 19:37)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> FYI it appears the methods in isd_s3.py with leading underscores are not available outside the module (i.e. they are available only inside the module library):</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">isd_s3.isd_s3</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">_get_session</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">'_get_session'</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
<p>I'm going to remove the leading underscore on the method names in the library and see if that fixes it.</p>



<a name="6957"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6957" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6957">(Apr 21 2020 at 19:48)</a>:</h4>
<p>That's really strange. Maybe I missed a PIP recently.</p>



<a name="6958"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6958" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6958">(Apr 21 2020 at 19:51)</a>:</h4>
<p>I think this behavior can be overridden by declaring it in the __all__ variable in __init__.py, but that seems more work than necessary.  Easier to remove the leading underscore.</p>



<a name="6959"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6959" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6959">(Apr 21 2020 at 19:55)</a>:</h4>
<p>This explains it well: <a href="https://dbader.org/blog/meaning-of-underscores-in-python" target="_blank" title="https://dbader.org/blog/meaning-of-underscores-in-python">https://dbader.org/blog/meaning-of-underscores-in-python</a></p>



<a name="6960"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6960" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6960">(Apr 21 2020 at 19:59)</a>:</h4>
<p>ohh, I see. It's because the * in the import. I didn't know that was different.<br>
You could still do: </p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">isd_s3</span> <span class="kn">import</span> <span class="n">isd_s3</span>
<span class="n">isd_s3</span><span class="o">.</span><span class="n">_get_session</span><span class="p">()</span>
</pre></div>


<p>anyway, better to remove the leading _ if it's not going to be used internally anyway.</p>



<a name="6961"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/6961" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#6961">(Apr 21 2020 at 20:03)</a>:</h4>
<p>Yeah , since I'm calling the functions from outside the module, it's better to remove the underscore.  But I'll keep the underscore on variable names that remain internal (e.g. _is_imported).  Also will keep underscore on function names in __main__.py</p>



<a name="7026"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7026" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7026">(Apr 22 2020 at 20:52)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> do you know what the default endpoint_url is if it's undefined when creating a boto3 client?  Documentation doesn't make this clear.  I'm leaning toward passing the url either as a command line argument or environment variable, and it will be up to the user to set this correctly (we define it in our cli.py entry-point script).  Tempted to allow for an undefined url as shown in the documentation, and wonder what the result of that would be.</p>



<a name="7027"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7027" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7027">(Apr 22 2020 at 21:02)</a>:</h4>
<p><span class="user-mention" data-user-id="55">@Tom Cram</span> I tested it out and the default is "<a href="https://s3.amazonaws.com" target="_blank" title="https://s3.amazonaws.com">https://s3.amazonaws.com</a>". I guess since boto3 was built by amazon, they assume you're using their s3.</p>



<a name="7031"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7031" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7031">(Apr 22 2020 at 21:06)</a>:</h4>
<p>Roger.  I think it's ok to allow for it to be undefined, since there's a possibility other users would be using an AWS endpoint.</p>



<a name="7173"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7173" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7173">(Apr 24 2020 at 16:50)</a>:</h4>
<p>I'm done with the PyInstaller executable build, and it's located at /glade/u/home/rdadata/bin/isd_s3_test.  I have only tested list_buckets(), so we'll need to test out the other functions soon.  But I'm going to go ahead and start a pull request to the master branch.</p>



<a name="7174"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7174" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7174">(Apr 24 2020 at 16:57)</a>:</h4>
<p>A comment about user configuration.  I put the isd_s3.ini config file in the same directory as the rda AWS credentials configuration (/glade/u/home/rdadata/.aws), since this seems like the most logical place for it to reside.  I think this type of configuration setup (reading from a config file) should be completely detached from the package repo.  It should be up to other users to decide if they want to implement their own config file setup when they develop their own apps.  Config options supported by the package can be 1. Environment variables or 2. Command line argument input</p>



<a name="7177"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7177" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7177">(Apr 24 2020 at 17:14)</a>:</h4>
<p>Some other minor issues:</p>
<ol>
<li>
<p>I renamed <code>exit()</code> to <code>exit_session()</code> in <code>isd_s3.py</code>.  This was causing a conflict with the built-in system function <code>exit()</code> when I imported the library with <code>from isd_s3.isd_s3 import*</code></p>
</li>
<li>
<p>In <code>__main__.py</code>, I renamed the boolean variable <code>pretty_print</code> to <code>pp</code>, since this was creating a conflict with the function <code>pretty_print()</code> in <code>isd_s3.py</code></p>
</li>
</ol>



<a name="7178"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7178" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7178">(Apr 24 2020 at 17:36)</a>:</h4>
<p>No conflicts in the pull request ... woo hoo!</p>



<a name="7186"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7186" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7186">(Apr 24 2020 at 19:57)</a>:</h4>
<p><span class="user-mention" data-user-id="55">@Tom Cram</span>  Are we still going to allow people to run the package directly assuming they have the correct environment? Basically, pyinstaller will be a suggestion to outside groups?</p>



<a name="7188"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7188" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7188">(Apr 24 2020 at 20:06)</a>:</h4>
<p>They can run it directly by calling <code>isd_s3.__main__.py</code>.  I don't think we should support the pyinstaller option since that gets into user case specifics.</p>



<a name="7189"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7189" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7189">(Apr 24 2020 at 20:16)</a>:</h4>
<p>But we nevertheless should put our cli script under Github control.  Does it make sense to put it under the rda-object-storage repo?</p>



<a name="7193"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7193" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7193">(Apr 24 2020 at 20:38)</a>:</h4>
<p>I think we could probably put it in an <code>examples/</code> directory. To keep it in one place. <br>
We could separate out <code>examples/pyinstaller/</code> and <code>examples/notebooks/</code><br>
What do you think?</p>



<a name="7194"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7194" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7194">(Apr 24 2020 at 20:38)</a>:</h4>
<p>That sounds good</p>



<a name="7223"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7223" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7223">(Apr 24 2020 at 23:25)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> Let me know when you've reviewed the pull request, and I'll merge it when you're ready.</p>



<a name="7224"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7224" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7224">(Apr 25 2020 at 00:20)</a>:</h4>
<p>Yeah, I looked over it and there are a few things that I've been changing. Anyway, maybe it would be best to merge now, and we can go over it next week.</p>



<a name="7248"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7248" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7248">(Apr 27 2020 at 15:19)</a>:</h4>
<p>Ok, I'll merge it this morning</p>



<a name="7255"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7255" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7255">(Apr 27 2020 at 16:12)</a>:</h4>
<p>Merge completed</p>



<a name="7263"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7263" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Riley Conroy <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7263">(Apr 27 2020 at 17:13)</a>:</h4>
<p><span class="user-mention" data-user-id="55">@Tom Cram</span> <br/>
What are your thoughts about changing isd_s3 to be a class that holds the functions that interact with s3? The __init__() could start the boto3 session, and the client would be a member variable. I see quite a bit of shared state that might be good to encapsulate.</p>
<p>Also, might be worth is to move some of this configuration to its own module so it can be reused.</p>



<a name="7270"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7270" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7270">(Apr 27 2020 at 18:28)</a>:</h4>
<p>I was thinking the same, both for the isd_s3 class and a separate config module</p>



<a name="7271"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/7271" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#7271">(Apr 27 2020 at 18:36)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> Let me know when you've completed the changes you were working on at the end of last week.  At that point I can rebuild a new PyInstaller executable and push a new release to <a href="http://PyPI.org" target="_blank" title="http://PyPI.org">PyPI.org</a>.</p>



<a name="10557"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/25-DECS/topic/s3-API/near/10557" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tom Cram <a href="http://127.0.0.1:4000/html/stream/25-DECS/topic/s3-API.html#10557">(Jun 04 2020 at 21:17)</a>:</h4>
<p><span class="user-mention" data-user-id="57">@Riley Conroy</span> Package has been uploaded to <a href="http://PyPI.org" target="_blank" title="http://PyPI.org">PyPI.org</a>, and you can go ahead and rebuild the pyinstaller executable.</p>



<hr><p>Last updated: Dec 17 2024 at 18:57 UTC</p>
</html>