<html>
<head><meta charset="utf-8"><title>model configuration · 0.1° JRA BGC Run · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/index.html">0.1° JRA BGC Run</a></h2>
<h3>Topic: <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html">model configuration</a></h3>

<hr>

<base href="https://zulip2.cloud.ucar.edu">

<head><link href="http://127.0.0.1:4000/style.css" rel="stylesheet"></head>

<a name="3175"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/3175" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gokhan Danabasoglu <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#3175">(Mar 13 2020 at 21:09)</a>:</h4>
<p>Regarding the drift and deep isopycnal mixing values.... Are you planning to use isopycnal mixing in these simulations? Submeso can be turned on as it is separate than the iso/GM part.</p>



<a name="3275"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/3275" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#3275">(Mar 14 2020 at 23:04)</a>:</h4>
<p>We're planning on configuring the physics hi-res experiment as the existing JRA hi-res run has been done, except for updating the JRA forcing. This enables us to (mostly) cleanly initialize the physics from the existing run. So I don't think we are considering turning on submeso in the hi-res.</p>
<p>The lo-res companion experiment serves 2 purposes, spinning up near-surface BGC tracers for initializing them in the hi-res experiment, and for comparison to the hi-res experiment. For the lo-res, we are not tied to an existing lo-res configuration. We are considering decreased deep Redi min so that tracer drift is more comparable to the hi-res. There is also experience with this configuration. While we could turn off submeso in the lo-res, in order to be more compatible with the hi-res, I'm less sure about our experience with this configuration with JRA forcing.</p>



<a name="3279"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/3279" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gokhan Danabasoglu <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#3279">(Mar 15 2020 at 16:11)</a>:</h4>
<p>Thank you for this explanation. Although I do not disagree fundamentally for the desire to "match" what was done before, I see this also as an impediment to try new things in the high-res simulations. We seem to be following what was done over 5 years ago. Certain missing physics is being propagated and I can see ourselves following similar approaches in the future for comparisons to existing simulations. Not sure when is ever the right time to revisit some of these choices.</p>



<a name="3280"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/3280" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Long <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#3280">(Mar 16 2020 at 13:51)</a>:</h4>
<p><span class="user-mention" data-user-id="62">@Gokhan Danabasoglu</span>, are you advocating for turning submeso on in the hi-res configuration?</p>



<a name="3424"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/3424" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fred Castruccio <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#3424">(Mar 17 2020 at 00:32)</a>:</h4>
<p>I think we should have submeso and isopycnal mixing for the tracers in the hires configuration. Maybe not in this first BGC run but in the future.</p>



<a name="4309"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/4309" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#4309">(Mar 20 2020 at 17:54)</a>:</h4>
<p>I'm starting to put together a tag for this, based on <code>cesm2_2_alpha04d</code>. It looks CIME has the JRA configuration updates that <span class="user-mention" data-user-id="31">@Keith Lindsay</span> brought in to CESM 2.1 [in other words, the CIME team has merged <code>maint-5.6</code> into <code>master</code>], but the POP tag is still missing those updates. I'll talk to Alper this afternoon, but I think the best plan forward is to merge the <code>cesm2_1_x_rel</code>branch onto POP's <code>master</code> branch, make a new tag, and then start a branch for this run off of that new tag. Does that seem like a reasonable path? Another option is to make a new branch now and cherry-pick Keith's JRA changes onto it, but I think that will complicate the process of merging this branch back onto <code>master</code></p>



<a name="6786"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6786" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6786">(Apr 17 2020 at 22:53)</a>:</h4>
<p><code>cesm2_2_beta04</code> has been tagged, and I'm using that as a starting point for the <code>highres_JRA_BGC</code> branch of POP. So far I've created the following compset</p>
<div class="codehilite"><pre><span></span> &lt;compset&gt;
   &lt;!-- latest JRA forcing, ecosys, high-res --&gt;
   &lt;alias&gt;GIAFECO_JRA_HR&lt;/alias&gt;
   &lt;lname&gt;2000_DATM%JRA-1p4-2018_SLND_CICE_POP2%ECO_DROF%JRA-1p4-2018_SGLC_SWAV&lt;/lname&gt;
 &lt;/compset&gt;
</pre></div>
<p>and modified <code>build-namelist</code> so it doesn't look for <code>dust_flux_input%{filename,file_fmt,file_varname}</code> when <code>dust_flux_source == 'driver'</code> (similar modification for <code>iron_flux_input</code> when <code>iron_flux_source == 'driver-derived'</code>). It looks like I need a file for <code>fesedflux</code> to continue</p>
<div class="codehilite"><pre><span></span>ERROR: Command /glade/work/mlevy/codes/CESM/cesm2_2_beta04+GECO_JRA_HR/components/pop/bld/build-namelist failed rc=255
out=build-namelist - ERROR: No default value found for fesedflux_input%filename
user defined attributes:
err=Died at /glade/work/mlevy/codes/CESM/cesm2_2_beta04+GECO_JRA_HR/components/pop/bld/build-namelist line 2370.
</pre></div>
<p><span class="user-mention" data-user-id="14">@Matt Long</span> have you created one, or should I start by setting the field to 0?</p>



<a name="6794"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6794" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6794">(Apr 17 2020 at 22:57)</a>:</h4>
<p>For now I'm just trying to get a <code>SMS_Ld1.TL319_t13.GIAFECO_JRA_HR.cheyenne_intel.pop-performance_eval</code> test built and running. Once I've cleared that hurdle, I'll move on to a longer run to get a better feel for the total model cost with output disabled... (note to self:  I still need to update the <code>OCN_BGC_CONFIG</code> variable to turn on the coccolithophores)</p>



<a name="6806"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6806" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6806">(Apr 17 2020 at 23:04)</a>:</h4>
<p>And it looks like the plan for tracer initial conditions is "BGC 1° spin-up" -- if someone (<span class="user-mention" data-user-id="31">@Keith Lindsay</span> ?) can point me to that run, I can map fields to the high-res grid (unless that's been done already? apologies if I missed a post about it in this channel)</p>



<a name="6815"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6815" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Long <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6815">(Apr 20 2020 at 15:00)</a>:</h4>
<p>I haven't generated one yet, but am close. If this is holding you up, set the field to zero.</p>



<a name="6841"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6841" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Long <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6841">(Apr 20 2020 at 17:24)</a>:</h4>
<p>This dataset contains a <strong>preliminary</strong> <code>fesedflux</code> file for the <code>tx0.1v3</code> grid:</p>
<div class="codehilite"><pre><span></span>/glade/work/mclong/cesm_inputdata/fesedflux_total_reduce_oxic_POP_tx0.1v3.c200420.nc
</pre></div>


<p><strong>This is preliminary and will certainly change.</strong></p>
<p>The algorithm is generating much lower Fe flux at hi-res than the same code for lo-res. I need to look into this. However, this file should permit functional evaluation of the model. </p>
<p>I have made this file into 64bit-offset format, using this function:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ncks_fl_fmt64bit</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts file to netCDF-3 64bit by calling:</span>
<span class="sd">      ncks --fl_fmt=64bit</span>

<span class="sd">    Parameter</span>
<span class="sd">    ---------</span>
<span class="sd">    file : str</span>
<span class="sd">      The file to convert.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ncks_cmd</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;ncks&#39;</span><span class="p">,</span> <span class="s1">&#39;-O&#39;</span><span class="p">,</span> <span class="s1">&#39;--fl_fmt=64bit&#39;</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">file</span><span class="p">])</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39; &amp;&amp; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;module load nco&#39;</span><span class="p">,</span> <span class="n">ncks_cmd</span><span class="p">])</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
        <span class="k">raise</span>
</pre></div>


<p>In previous attempts to write netCDF3 from xarray, I found it was not possible. Perhaps this has been fixed, but I haven't checked. I believe that the model cannot read netCDF4 on some machines?</p>



<a name="6843"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6843" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6843">(Apr 20 2020 at 17:34)</a>:</h4>
<p><span class="user-mention" data-user-id="10">@Michael Levy</span> , we don't currently have IC for hi-res BGC, particularly with explicit cocco. I'll put something together today for your testing.</p>



<a name="6844"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6844" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6844">(Apr 20 2020 at 17:35)</a>:</h4>
<p>Thanks Keith! No need to include cocco, first run will be without it and I think I still have a script or notebook from when Kristen and I added cocco to the x1 initial condition file</p>



<a name="6845"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6845" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6845">(Apr 20 2020 at 17:40)</a>:</h4>
<p><span class="user-mention" data-user-id="14">@Matt Long</span> </p>
<blockquote>
<p>In previous attempts to write netCDF3 from xarray, I found it was not possible. Perhaps this has been fixed, but I haven't checked. I believe that the model cannot read netCDF4 on some machines?</p>
</blockquote>
<p>This is correct, in fact I ran into issues helping put together the current beta tag (that we are using as a starting point) because the current intel compiler on cheyenne causes PIO errrors when reading netCDF4 files. I think I was using</p>
<div class="codehilite"><pre><span></span>$ ncks -5 file_in.nc file_out.nc
</pre></div>
<p>To convert to <code>64bit_data</code> (rather than <code>64bit_offset</code>) but if I run into issues I'll let you know. I don't expect to.</p>



<a name="6846"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6846" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6846">(Apr 20 2020 at 17:42)</a>:</h4>
<p>("errrors" is a portmanteau of "errors" and the sound I made when I realized some files could be read by CESM 2.1 but not 2.2)</p>



<a name="6905"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6905" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6905">(Apr 20 2020 at 22:34)</a>:</h4>
<p>A few more updates:</p>
<ol>
<li>I created a new directory for preliminary inputdata: <code>/glade/p/cesmdata/cseg/inputdata/ocn/pop/tx0.1v3/tmp</code> with a <code>README</code> file explaining its purpose</li>
</ol>
<div class="codehilite"><pre><span></span>This is a temporary directory to house intermediate files while we set up BGC
forcings and initial conditions for a high-res JRA cycle. Once we are happy
with the results, files will be copied to ic/ or forcing/ as appropriate and
this directory will be removed.

Nothing in this directory should be imported to the inputdata repository!
</pre></div>


<p>I copied the preliminary fesedflux file from <code>/glade/work/mclong/cesm_inputdata/</code> and will add additional files as they are created. This seemed like a better solution than hacking <code>build-namelist</code> to avoid adding the <code>/glade/p/cesmdata/cseg/inputdata/</code> prefix to files.</p>
<ol start="2">
<li>The current <code>build-namelist</code> error is</li>
</ol>
<div class="codehilite"><pre><span></span>ERROR: Command /glade/work/mlevy/codes/CESM/cesm2_2_beta04+GECO_JRA_HR/components/pop/bld/build-namelist failed rc=255
out=build-namelist - ERROR: No default value found for nox_flux_monthly_input%filename
</pre></div>


<p>The overview mentions</p>
<blockquote>
<p>Atm NOx, NHy: cycle 1850</p>
</blockquote>
<p>I assume that still needs to be done.</p>



<a name="6907"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6907" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Long <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6907">(Apr 20 2020 at 22:38)</a>:</h4>
<p><span class="user-mention" data-user-id="31">@Keith Lindsay</span> may already have Ndep fields interpolated.</p>



<a name="6910"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6910" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6910">(Apr 20 2020 at 23:14)</a>:</h4>
<p>Yes, Ndep is available at<br>
/glade/p/cgd/oce/people/klindsay/oldcgdoce/BGC_2/ndep/ndep_ocn_1850_w_nhx_emis_tx0.1v3_c191115.nc</p>



<a name="6915"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6915" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6915">(Apr 20 2020 at 23:36)</a>:</h4>
<p>Thanks Keith! I copied it to the <code>tmp/</code> directory I created in inputdata, and that brings us to</p>
<div class="codehilite"><pre><span></span>ERROR: Command /glade/work/mlevy/codes/CESM/cesm2_2_beta04+GECO_JRA_HR/components/pop/bld/build-namelist failed rc=255
out=build-namelist - ERROR: No default value found for riv_flux_shr_stream_file
</pre></div>


<p>and</p>
<blockquote>
<p>River nutrients: set to 1900 (same mapping files as runoff)</p>
</blockquote>
<p>I don't suppose you have that file floating around? (It looks like you created the x1 version <code>riv_nut.gnews_gnm.JRA025m_to_gx1v7_nn_open_ocean_nnsm_e1000r300_marginal_sea_190214.20190602.nc</code> and also the map from JRA -&gt; t13 <code>/glade/p/cesmdata/cseg/inputdata/cpl/gridmaps/rJRA025/map_JRA025m_to_tx0.1v3_nnsm_e333r100_190226.nc</code>)</p>



<a name="6916"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6916" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6916">(Apr 21 2020 at 02:40)</a>:</h4>
<p>I do not have the BGC riv flux forcings for tx0.1v3.</p>
<p>I think that <span class="user-mention" data-user-id="14">@Matt Long</span> was going to do that, and I recall him saying that his riv flux regridding scripts needed some generalizing work.</p>
<p>I didn't create the gx1v7 riv flux file, I copied it to inputdata from /glade/work/mclong/cesm_inputdata/.</p>
<p>I also didn't create the JRA025m -&gt; tx0.1v3 nnsm mapping file. I copied it to inputdata from<br/>
/glade/work/altuntas/cesm.input/mapping/JRA025m_tx0.1v3/</p>



<a name="6936"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6936" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Long <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6936">(Apr 21 2020 at 19:15)</a>:</h4>
<p>The riverine nutrient dataset uses the same mapping files as freshwater, so I will need to ensure that the nutrient data are on the relevant  runoff grid. It's on my list.</p>



<a name="6969"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/6969" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#6969">(Apr 21 2020 at 21:40)</a>:</h4>
<p>It looks like the nutrient file on JRA grid is <code>/glade/work/mclong/cesm_inputdata/work/river_nutrients.GNEWS_GNM.JRA55.20190602.nc</code> and the mapping file for JRA -&gt; 0.1 deg is <code>/glade/p/cesmdata/cseg/inputdata/cpl/gridmaps/rJRA025/map_JRA025m_to_tx0.1v3_nnsm_e333r100_190226.nc</code></p>



<a name="7013"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/7013" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#7013">(Apr 22 2020 at 19:52)</a>:</h4>
<p>I expect to have a hi-res BGC IC late tonight. It will be obs for macro-nutrients, O2, DIC, and ALK. Everything else is from the CESM2 piControl restart file at 0501-01-01. This is what was done for OMIP IC. I've got a notebook that generates this running now, though it is kinda slow. It's taking ~30 minutes per tracer.  The lateral fill after lateral regridding and smoothing of the fill takes nearly 99% of this time.</p>



<a name="7164"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/7164" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#7164">(Apr 23 2020 at 23:54)</a>:</h4>
<p>Here is an obs based IC:<br>
<code>/glade/work/klindsay/cesm_inputdata/ecosys_jan_IC_omip_POP_tx0.1v3_c200423.nc</code><br>
It does not include explicit coccolithophore tracers.</p>



<a name="7181"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/7181" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#7181">(Apr 24 2020 at 19:03)</a>:</h4>
<p>So it looks like the three files still missing are</p>
<div class="codehilite"><pre><span></span>riv_flux_shr_stream_file
restore_data_filenames_derived
restore_inv_tau_input%filename
</pre></div>
<p>I know <span class="user-mention" data-user-id="14">@Matt Long</span> is working on the river flux file, but I don't think I've heard anything about tracer restoring.</p>
<p>Also, I found the first bug from when I cleaned up the buggy merge of <code>maint-5.6</code> into <code>master</code> in CIME... I didn't get the JRA025v2 -&gt; tx0.1v3 runoff map file name right at <a href="https://github.com/ESMCI/cime/blob/master/config/cesm/config_grids_common.xml#L257" target="_blank" title="https://github.com/ESMCI/cime/blob/master/config/cesm/config_grids_common.xml#L257">https://github.com/ESMCI/cime/blob/master/config/cesm/config_grids_common.xml#L257</a> (there should be an <code>_nnsm_</code> between <code>tx0.1v3</code> and <code>e333r100</code>), so I'll set up a CIME branch for this experiment tag as well.</p>



<a name="7185"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/7185" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#7185">(Apr 24 2020 at 19:27)</a>:</h4>
<p>I propose that BGC restoring could be turned off in your initial test runs.<br>
It looks like this could be accomplished by having the following in user_nl_marbl</p>
<div class="codehilite"><pre><span></span>tracer_restore_vars(1) = &quot;&quot;
tracer_restore_vars(2) = &quot;&quot;
tracer_restore_vars(3) = &quot;&quot;
tracer_restore_vars(4) = &quot;&quot;
tracer_restore_vars(5) = &quot;&quot;
</pre></div>


<p>(I'm not sure if these lines can be replaced with <code>tracer_restore_vars = ""</code>.)<br>
I think you could then put <code>restore_data_filenames_derived='none'</code> into user_nl_pop.<br>
I suggest modifying build-namelist to only call <code>add_default</code> for <code>restore_inv_tau_input%*</code> nml vars if <code>restore_inv_tau_opt= file_time_invariant</code>, similar to what we do for <code>ciso_atm_d14c_filename</code> only getting written if <code>ciso_atm_opt=file</code>. Then you wouldn't need to specify <code>restore_inv_tau_input%filename</code>, as the default for <code>restore_inv_tau_opt</code> is <code>const</code>. (I'm being sloppy with exact build-namelist syntax here.)</p>



<a name="7190"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/7190" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#7190">(Apr 24 2020 at 20:17)</a>:</h4>
<p>I think you can run without BGC river fluxes by adding <code>riv_flux_shr_stream_file='unknown'</code> to user_nl_pop.<br>
This would be a workaround until that forcing is available.</p>



<a name="7191"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/7191" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#7191">(Apr 24 2020 at 20:18)</a>:</h4>
<p>Good thoughts, Keith! What I've done is alter <code>build-namelist</code> to look at the length of <code>restorable_tracer_names(1)</code> and only add <code>restore_data_filenames_derived</code> to the namelist if the length is non-zero. In that same block of logic, the value of <code>restore_inv_tau_opt</code> determines whether <code>restore_inv_tau_const</code> or <code>restore_inv_tau_input%[*]</code> gets added to well (with nothing added if no tracers are being restored).</p>
<p>This is definitely a good short-term fix for getting an initial test up and running, but I need to think about it a little more before determining whether it should stay in the code long-term or get pulled out. The big question mark in my mind is how POP's <code>restorable_tracer_names</code> interacts with MARBL's<code>tracer_restore_vars</code>. I think they are independent, but POP will throw an error in initialization if MARBL lists a tracer in <code>tracer_restore_vars</code> that is not in POP's <code>restorable_tracer_names</code>... in which case I think it's okay to only include <code>restore_data_filenames_derived</code>, <code>restore_inv_tau_opt</code>, and either <code>restore_inv_tau_const</code> or <code>restore_inv_tau_input%[*]</code> in pop_in if <code>restorable_tracer_names</code> contains at least 1 tracer.</p>
<p>Also, it's worth noting that the MARBL default for <code>tracer_restore_vars</code> is also empty unless we're running on the <code>x1</code> or <code>x3</code>; so at least for now no mods are required in <code>user_nl_marbl</code></p>



<a name="14117"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14117" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14117">(Jul 17 2020 at 18:26)</a>:</h4>
<p>I think things are ready to go when cheyenne is returned to service. The plan is to create a new case (<code>G1850ECOIAF_JRA_HR</code> compset, <code>TL319_t13</code> resolution) with the following mods:</p>
<p><strong>Some variables that will be used in multiple places</strong></p>
<div class="codehilite"><pre><span></span><span class="nv">ref_dir</span><span class="o">=</span>/glade/work/mlevy/hi-res_BGC_JRA/restarts_from_alper
<span class="nv">ref_case</span><span class="o">=</span>g.e20.G.TL319_t13.control.001_contd
<span class="nv">ref_date</span><span class="o">=</span><span class="m">0245</span>-01-01
</pre></div>


<p><strong>XML changes</strong></p>
<div class="codehilite"><pre><span></span>./xmlchange NTASKS_OCN=7507
./xmlchange STOP_N=3,STOP_OPTION=nmonths
./xmlchange JOB_WALLCLOCK_TIME=10:00:00,PROJECT=CESM0010
./xmlchange OCN_CHL_TYPE=prognostic
./xmlchange OCN_BGC_CONFIG=latest+cocco
./xmlchange RUN_TYPE=hybrid,RUN_REFCASE=${ref_case},RUN_REFDATE=${ref_date}
./xmlchange OCN_TRACER_MODULES=ecosys
./xmlchange -a CICE_CONFIG_OPTS=&quot;-trage 0&quot;
</pre></div>


<p><strong>Namelist changes</strong></p>
<div class="codehilite"><pre><span></span>cat &gt;&gt; user_nl_pop <span class="s">&lt;&lt; EOF</span>
<span class="s">! tavg namelist changes</span>
<span class="s">ltavg_ignore_extra_streams = .true.</span>
<span class="s">tavg_freq = 1 1 1 5</span>
<span class="s">tavg_freq_opt = &#39;nmonth&#39; &#39;nday&#39; &#39;nyear&#39; &#39;nday&#39;</span>
<span class="s">tavg_file_freq = 1 1 1 5</span>
<span class="s">tavg_file_freq_opt = &#39;nmonth&#39; &#39;nmonth&#39; &#39;nyear&#39; &#39;nday&#39;</span>
<span class="s">tavg_stream_filestrings = &#39;nmonth1&#39; &#39;nday1&#39; &#39;nyear1&#39; &#39;nday5&#39;</span>

<span class="s">! Pick correct override file</span>
<span class="s">! ----</span>
<span class="s">! 1958 - 1995 [245-282]:</span>
<span class="s">tavg_contents_override_file = &#39;/glade/work/mlevy/hi-res_BGC_JRA/tx0.1v3_tavg_contents_no5day&#39;</span>
<span class="s">n_tavg_streams = 3</span>
<span class="s">! 1996 - 2018 [283-305]:</span>
<span class="s">! tavg_contents_override_file = &#39;/glade/work/mlevy/hi-res_BGC_JRA/tx0.1v3_tavg_contents&#39;</span>
<span class="s">! n_tavg_streams = 4</span>

<span class="s">! Needed to get all MARBL diags defined correctly</span>
<span class="s">lecosys_tavg_alt_co2 = .true.</span>

<span class="s">! First run needs initial conditions for ecosys</span>
<span class="s">init_ecosys_option=&#39;ccsm_startup&#39;</span>
<span class="s">init_ecosys_init_file = &#39;/glade/p/cesmdata/cseg/inputdata/ocn/pop/tx0.1v3/ic/ecosys_jan_IC_omip_POP_tx0.1v3_c200617.nc&#39;</span>
<span class="s">EOF</span>

cat &gt;&gt; user_nl_cice <span class="s">&lt;&lt; EOF</span>
<span class="s">ndtd=2</span>
<span class="s">r_snw=1.00</span>
<span class="s">f_blkmask = .true.</span>
<span class="s">EOF</span>
</pre></div>


<p><strong>SourceMods</strong></p>
<div class="codehilite"><pre><span></span>cp /glade/work/mlevy/hi-res_BGC_JRA/SourceMods/marbl_interior_tendency_mod.F90 SourceMods/src.pop/
</pre></div>


<p>The source mod is just a small change to decrease the volume of warning messages written to <code>cesm.log</code>:</p>
<div class="codehilite"><pre><span></span>$ diff /glade/work/mlevy/codes/CESM/cesm2_2_alpha06a+pop_rel_candidates/components/pop/externals/MARBL/src/marbl_interior_tendency_mod.F90 /glade/work/mlevy/hi-res_BGC_JRA/SourceMods/marbl_interior_tendency_mod.F90
2502c2502
&lt;         if (domain%delta_z(k) * DOP_loss_P_bal .gt. Jint_Ptot_thres) then
---
&gt;         if (domain%delta_z(k) * DOP_loss_P_bal .gt. 1e4_r8*Jint_Ptot_thres) then
</pre></div>


<p>I'll just need to copy <code>${ref_dir}/${ref_date}-00000/*</code> to the run directory.</p>
<p>I'm not entirely clear on what is required for the <code>ALT_CO2</code> tracers, but conversation in <a href="#narrow/stream/20-0.2E1.C2.B0-JRA.20BGC.20Run/topic/ALT_CO2" title="#narrow/stream/20-0.2E1.C2.B0-JRA.20BGC.20Run/topic/ALT_CO2">the ALT_CO2 topic</a> makes it seem like we won't be doing anything different for them in the first few years of the run anyway.</p>



<a name="14121"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14121" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Long <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14121">(Jul 17 2020 at 18:55)</a>:</h4>
<p><span class="user-mention" data-user-id="10">@Michael Levy</span>: does this include the advection scheme settings we discussed?</p>



<a name="14122"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14122" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14122">(Jul 17 2020 at 19:08)</a>:</h4>
<p><span class="user-mention" data-user-id="14">@Matt Long</span> it does -- I talked to <span class="user-mention" data-user-id="31">@Keith Lindsay</span> about it and details about the implementation are at <a href="https://github.com/ESCOMP/POP2-CESM/pull/34#issuecomment-659633147" target="_blank" title="https://github.com/ESCOMP/POP2-CESM/pull/34#issuecomment-659633147">https://github.com/ESCOMP/POP2-CESM/pull/34#issuecomment-659633147</a></p>



<a name="14124"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14124" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14124">(Jul 17 2020 at 19:11)</a>:</h4>
<p><span class="user-mention" data-user-id="31">@Keith Lindsay</span> and <span class="user-mention" data-user-id="14">@Matt Long</span> : I've created a case at <code>/glade/work/mlevy/hi-res_BGC_JRA/cases/test_case_setup_script</code> if you could look at the namelists and make sure everything looks okay. For comparison, <code>pop_in</code> and <code>ice_in</code> from Alper's high-res runs are in <code>/glade/scratch/altuntas/temp/g.e20.G.TL319_t13.control.001_hfreq/CaseDocs</code></p>
<p>One set of changes that I didn't include in my list from earlier today (but have made in my sandbox); Alper had a few mods in <code>user_nl_pop</code> that I had missed:</p>
<div class="codehilite"><pre><span></span>! other changes from Alper (g.e20.G.TL319_t13.control.001_hfreq)
lcvmix = .false.
h_upper = 20.0
ltidal_mixing = .true.
</pre></div>



<a name="14126"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14126" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14126">(Jul 17 2020 at 19:13)</a>:</h4>
<p>I'd like to get the run going as soon as cheyenne is back up, so if anything looks off I'll fix it now</p>



<a name="14134"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14134" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14134">(Jul 17 2020 at 21:13)</a>:</h4>
<p><span class="user-mention" data-user-id="10">@Michael Levy</span> , here are some differences between Alper's env_run.xml and your.<br>
'&lt;' is Alper's case, '&gt;' is yours.</p>
<div class="codehilite"><pre><span></span>&lt;     &lt;entry id=&quot;ATM2OCN_FMAPNAME&quot; value=&quot;/glade/work/fredc/cesm/mapping_JRA55/map_TL319_TO_tx0.1v3_patc_blin_merged.180705.nc&quot;&gt;
&gt;     &lt;entry id=&quot;ATM2OCN_FMAPNAME&quot; value=&quot;cpl/gridmaps/TL319/map_TL319_TO_tx0.1v3_patc.170730.nc&quot;&gt;
&lt;     &lt;entry id=&quot;ATM2OCN_SMAPNAME&quot; value=&quot;/glade/work/fredc/cesm/mapping_JRA55/map_TL319_TO_tx0.1v3_patc_blin_merged.180705.nc&quot;&gt;
&gt;     &lt;entry id=&quot;ATM2OCN_SMAPNAME&quot; value=&quot;cpl/gridmaps/TL319/map_TL319_TO_tx0.1v3_patc.170730.nc&quot;&gt;
&lt;     &lt;entry id=&quot;ATM2OCN_VMAPNAME&quot; value=&quot;/glade/work/fredc/cesm/mapping_JRA55/map_TL319_TO_tx0.1v3_patc_blin_merged.180705.nc&quot;&gt;
&gt;     &lt;entry id=&quot;ATM2OCN_VMAPNAME&quot; value=&quot;cpl/gridmaps/TL319/map_TL319_TO_tx0.1v3_patc.170730.nc&quot;&gt;
&lt;     &lt;entry id=&quot;ROF2OCN_LIQ_RMAPNAME&quot; value=&quot;cpl/gridmaps/rJRA025/map_JRA025m_to_tx0.1v3_e333r100_170830.nc&quot;&gt;
&gt;     &lt;entry id=&quot;ROF2OCN_LIQ_RMAPNAME&quot; value=&quot;cpl/gridmaps/rJRA025/map_JRA025m_to_tx0.1v3_nnsm_e333r100_190226.nc&quot;&gt;
&lt;     &lt;entry id=&quot;ROF2OCN_ICE_RMAPNAME&quot; value=&quot;cpl/gridmaps/rJRA025/map_JRA025m_to_tx0.1v3_e333r100_170830.nc&quot;&gt;
&gt;     &lt;entry id=&quot;ROF2OCN_ICE_RMAPNAME&quot; value=&quot;cpl/gridmaps/rJRA025/map_JRA025m_to_tx0.1v3_nnsm_e333r100_190226.nc&quot;&gt;
&lt;     &lt;entry id=&quot;CPL_SEQ_OPTION&quot; value=&quot;RASM_OPTION1&quot;&gt;
&gt;     &lt;entry id=&quot;CPL_SEQ_OPTION&quot; value=&quot;CESM1_MOD&quot;&gt;
</pre></div>


<p>I suspect that the ROF2OCN changes are from the updated JRA drof definition, so we want your values.<br>
But we might want Alper's values for the ATM2OCN and CPL_SEQ_OPTION entries.<br>
There are xmlchange commands in his CaseStatus for these variables.</p>



<a name="14135"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14135" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14135">(Jul 17 2020 at 21:17)</a>:</h4>
<p>Maybe we should seek Alper's input on why he made these changes from whatever the defaults were for his case.</p>



<a name="14136"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14136" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14136">(Jul 17 2020 at 21:17)</a>:</h4>
<p>I'll send him an email and ask (I can cc you if you'd like)</p>



<a name="14137"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14137" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14137">(Jul 17 2020 at 21:18)</a>:</h4>
<p>yes please</p>



<a name="14140"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14140" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14140">(Jul 17 2020 at 21:37)</a>:</h4>
<p>I wish I had noticed this earlier... if we do use the updated <code>ATM2OCN</code> mapping file, I'd have updated <code>config/cesm/config_grids_mct.xml</code> in CIME to get it by default (maybe I can still sneak that update in). The mapping file was copied from Fred's work directory to <code>/glade/p/cesmdata/cseg/inputdata/cpl/gridmaps/TL319/map_TL319_TO_tx0.1v3_patc_blin_merged.180705.nc</code>, so at least I can use the version in inputdata</p>



<a name="14149"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14149" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14149">(Jul 17 2020 at 22:10)</a>:</h4>
<p>Alper confirmed that we should use the updated maps. He didn't recall the reasoning behind changing <code>CPL_SEQ_OPTION</code> but for consistency I think we should match his runs. To that end, <code>/glade/work/mlevy/hi-res_BGC_JRA/cases/test_case_setup_script.002</code> was built from a sandbox with cime mods (<a href="https://github.com/ESMCI/cime/pull/3624" target="_blank" title="https://github.com/ESMCI/cime/pull/3624">https://github.com/ESMCI/cime/pull/3624</a>) for the <code>ATM2OCN</code> maps and an <code>xmlchange</code> command for <code>CPL_SEQ_OPTION</code></p>



<a name="14161"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14161" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14161">(Jul 20 2020 at 14:18)</a>:</h4>
<p><span class="user-mention" data-user-id="10">@Michael Levy</span> , I've think that I've got my notebook for regridded from g17 to t13 ready. Can you please point me to the low-res 2-cycle JRA55 case of <span class="user-mention" data-user-id="28">@Kristen Krumhardt</span> that has the same marbl settings that are being used in the hi-res case? Thanks.</p>



<a name="14166"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14166" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14166">(Jul 20 2020 at 14:48)</a>:</h4>
<p><span class="user-mention" data-user-id="31">@Keith Lindsay</span> I believe it's the output in <code>/glade/scratch/kristenk/archive/g.e22b05.G1850ECOIAF_JRA.TL319_g17
.cocco.001</code>, though I'd like <span class="user-mention" data-user-id="28">@Kristen Krumhardt</span> to verify</p>



<a name="14178"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14178" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kristen Krumhardt <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14178">(Jul 20 2020 at 15:47)</a>:</h4>
<p>Yes, Mike has the right path</p>



<a name="14179"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14179" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14179">(Jul 20 2020 at 16:53)</a>:</h4>
<p>Thanks for confirming this.</p>



<a name="14184"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14184" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14184">(Jul 20 2020 at 20:01)</a>:</h4>
<p><span class="user-mention" data-user-id="10">@Michael Levy</span>, the new obs based IC is<br>
/glade/scratch/klindsay/cesm_inputdata/ecosys_jan_IC_omip_plus_g.e22b05.G1850ECOIAF_JRA.TL319_g17.cocco.001_0123-01-01_POP_tx0.1v3_c200720.nc<br>
I think this should be ready to go, with no additional processing.</p>



<a name="14209"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14209" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Keith Lindsay <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14209">(Jul 20 2020 at 22:58)</a>:</h4>
<p><span class="user-mention" data-user-id="10">@Michael Levy</span> , the IC based just on Kristen's case is<br>
/glade/scratch/klindsay/cesm_inputdata/ecosys_jan_IC_g.e22b05.G1850ECOIAF_JRA.TL319_g17.cocco.001_0123-01-01_POP_tx0.1v3_c200720.nc</p>



<a name="14210"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14210" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14210">(Jul 20 2020 at 23:01)</a>:</h4>
<p><span class="user-mention" data-user-id="31">@Keith Lindsay</span> -- thanks! I copied the file to <code>/glade/p/cesmdata/cseg/inputdata/ocn/pop/tx0.1v3/tmp/ecosys_jan_IC_omip_plus_g.e22b05.G1850ECOIAF_JRA.TL319_g17.cocco.001_0123-01-01_POP_tx0.1v3_c200720.nc</code> and am back to waiting for my job to start... hopefully it'll go overnight, it's been in the queue for almost 3 hours already.</p>



<a name="14211"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14211" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14211">(Jul 20 2020 at 23:01)</a>:</h4>
<p>oh, wait... your second link is a different file. I'll get that job queued up as well</p>



<a name="14212"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/20-0.1%C2%B0%20JRA%20BGC%20Run/topic/model%20configuration/near/14212" class="zl"><img src="http://127.0.0.1:4000/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Levy <a href="http://127.0.0.1:4000/html/stream/20-0.2E1.C2.B0-JRA-BGC-Run/topic/model.20configuration.html#14212">(Jul 20 2020 at 23:02)</a>:</h4>
<p>The job with the WOA / Kristen combined initial conditions is queued, and I'll submit the "Kristen IC w/ out WOA" ASAP</p>



<hr><p>Last updated: Dec 17 2024 at 18:57 UTC</p>
</html>