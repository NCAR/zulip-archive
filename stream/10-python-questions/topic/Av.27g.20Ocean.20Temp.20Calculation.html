<html>
<head><meta charset="utf-8"><title>Av&#x27;g Ocean Temp Calculation · python-questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="../../..//stream/10-python-questions/index.html">python-questions</a></h2>
<h3>Topic: <a href="../../..//stream/10-python-questions/topic/Av.27g.20Ocean.20Temp.20Calculation.html">Av&#x27;g Ocean Temp Calculation</a></h3>

<hr>


<head><link href="../../../style.css" rel="stylesheet"></head>

<a name="56426"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/10-python-questions/topic/Av%27g%20Ocean%20Temp%20Calculation/near/56426" class="zl"><img src="../../../assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mira Berdahl <a href="../../..//stream/10-python-questions/topic/Av.27g.20Ocean.20Temp.20Calculation.html#56426">(Jun 10 2022 at 18:45)</a>:</h4>
<p>I'm trying to calculated mean ocean temperatures below 700m.  I'm using the weighted function to weight by the layer thickness, but most of my result ends up being NANs because of they are present at depth in shallower areas.  Is there a way around this? I've taken a few screenshots of simplified workflow showing the basic issue.  Any thoughts on how to work around this?</p>
<p><a href="../../../user_uploads/2/9b/wz-_7z7LY_rNRz8WDyDklBoc/Screen-Shot-2022-06-10-at-11.44.00-AM-2.png">Screen-Shot-2022-06-10-at-11.44.00-AM-2.png</a> <a href="../../../user_uploads/2/6e/ZOJpRi12FPy3LhoCyAWbOBsL/Screen-Shot-2022-06-10-at-11.44.05-AM-2.png">Screen-Shot-2022-06-10-at-11.44.05-AM-2.png</a></p>
<div class="message_inline_image"><a href="../../../user_uploads/2/9b/wz-_7z7LY_rNRz8WDyDklBoc/Screen-Shot-2022-06-10-at-11.44.00-AM-2.png" title="Screen-Shot-2022-06-10-at-11.44.00-AM-2.png"><img src="../../../user_uploads/2/9b/wz-_7z7LY_rNRz8WDyDklBoc/Screen-Shot-2022-06-10-at-11.44.00-AM-2.png"></a></div><div class="message_inline_image"><a href="../../../user_uploads/2/6e/ZOJpRi12FPy3LhoCyAWbOBsL/Screen-Shot-2022-06-10-at-11.44.05-AM-2.png" title="Screen-Shot-2022-06-10-at-11.44.05-AM-2.png"><img src="../../../user_uploads/2/6e/ZOJpRi12FPy3LhoCyAWbOBsL/Screen-Shot-2022-06-10-at-11.44.05-AM-2.png"></a></div>



<a name="56449"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/10-python-questions/topic/Av%27g%20Ocean%20Temp%20Calculation/near/56449" class="zl"><img src="../../../assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen Yeager <a href="../../..//stream/10-python-questions/topic/Av.27g.20Ocean.20Temp.20Calculation.html#56449">(Jun 10 2022 at 22:09)</a>:</h4>
<p>Your method looks reasonable to me. Have you tried plotting your "xx" array? It's not surprising there are NaNs at low/high latitudes and a plot should show valid values where ocean is deeper than 700m.  Also, it looks like you need to request more memory when logging in to JupyterHub, as your memory usage exceeds your request.</p>



<a name="56450"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/10-python-questions/topic/Av%27g%20Ocean%20Temp%20Calculation/near/56450" class="zl"><img src="../../../assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mira Berdahl <a href="../../..//stream/10-python-questions/topic/Av.27g.20Ocean.20Temp.20Calculation.html#56450">(Jun 10 2022 at 22:27)</a>:</h4>
<p>Yes, I've tried plotting a map for a time slice and it is just blank (all NaNs).  I also thought it should show valid values.  I don't know what else I could try?  (And yes, will request more memory, thanks for the reminder)</p>



<a name="56485"></a>
<h4><a href="https://zulip2.cloud.ucar.edu#narrow/stream/10-python-questions/topic/Av%27g%20Ocean%20Temp%20Calculation/near/56485" class="zl"><img src="../../../assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mira Berdahl <a href="../../..//stream/10-python-questions/topic/Av.27g.20Ocean.20Temp.20Calculation.html#56485">(Jun 13 2022 at 18:15)</a>:</h4>
<p>This error actually looks like it had to do with pop-tools layer depths.  They are apparently slightly different (rounding error) than those in the actual POP temp files...</p>



<hr><p>Last updated: May 16 2025 at 17:14 UTC</p>
</html>