[
    {
        "content": "<p>Hi y'all!</p>\n<p>Trying to make a few functions that will work for processing data with apply_ufunc. The dataset is the air_temp example dataset.</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.preprocessing</span> <span class=\"kn\">import</span> <span class=\"n\">MinMaxScaler</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">minmax</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">):</span>\n    <span class=\"n\">scaler</span> <span class=\"o\">=</span> <span class=\"n\">MinMaxScaler</span><span class=\"p\">(</span>\n        <span class=\"n\">feature_range</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">))</span>\n\n    <span class=\"n\">min_max_scaled</span> <span class=\"o\">=</span> <span class=\"n\">scaler</span><span class=\"o\">.</span><span class=\"n\">fit_transform</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"k\">return</span> <span class=\"n\">min_max_scaled</span>\n</code></pre></div>\n<p>next cell is here:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">min_maxd</span> <span class=\"o\">=</span> <span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">apply_ufunc</span><span class=\"p\">(</span><span class=\"n\">minmax</span><span class=\"p\">,</span> <span class=\"n\">ds</span><span class=\"p\">,</span>\n        <span class=\"n\">input_core_dims</span><span class=\"o\">=</span><span class=\"p\">[[</span><span class=\"s1\">'time'</span><span class=\"p\">]],</span>\n        <span class=\"n\">vectorize</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>The output is a valueError:</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"ne\">ValueError</span><span class=\"p\">:</span> <span class=\"n\">Expected</span> <span class=\"mi\">2</span><span class=\"n\">D</span> <span class=\"n\">array</span><span class=\"p\">,</span> <span class=\"n\">got</span> <span class=\"mi\">1</span><span class=\"n\">D</span> <span class=\"n\">array</span> <span class=\"n\">instead</span><span class=\"p\">:</span>\n<span class=\"n\">array</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mf\">241.2</span>     <span class=\"mf\">242.09999</span> <span class=\"mf\">242.29999</span> <span class=\"o\">...</span> <span class=\"mf\">243.48999</span> <span class=\"mf\">245.79</span>    <span class=\"mf\">245.09</span>   <span class=\"p\">]</span><span class=\"o\">.</span>\n<span class=\"n\">Reshape</span> <span class=\"n\">your</span> <span class=\"n\">data</span> <span class=\"n\">either</span> <span class=\"n\">using</span> <span class=\"n\">array</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">your</span> <span class=\"n\">data</span> <span class=\"n\">has</span> <span class=\"n\">a</span> <span class=\"n\">single</span> <span class=\"n\">feature</span> <span class=\"ow\">or</span> <span class=\"n\">array</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"n\">contains</span> <span class=\"n\">a</span> <span class=\"n\">single</span> <span class=\"n\">sample</span><span class=\"o\">.</span>\n</code></pre></div>",
        "id": 67649,
        "sender_full_name": "Thomas Martin",
        "timestamp": 1667495393
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>input_core_dims=[[&#39;time&#39;]],\n        vectorize=True\n</code></pre></div>\n<p>This means,: \"provide my function with 1D arrays (only time) by looping over all other dimensions\". Sounds like you want the inverse where all dimensions but time are core dimensions, and then vectorize=True will loop over time.</p>",
        "id": 67652,
        "sender_full_name": "Deepak Cherian",
        "timestamp": 1667497147
    }
]