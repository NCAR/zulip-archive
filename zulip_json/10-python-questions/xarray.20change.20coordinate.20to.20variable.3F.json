[
    {
        "content": "<p>I want to change 'time' from a coordinate to a Data variable in an xarray Dataset. How do I do it?</p>",
        "id": 27211,
        "sender_full_name": "Stephen Yeager",
        "timestamp": 1616090916
    },
    {
        "content": "<p>There's a <code>.reset_coords()</code>: <a href=\"https://xarray.pydata.org/en/stable/generated/xarray.Dataset.reset_coords.html\" target=\"_blank\" title=\"https://xarray.pydata.org/en/stable/generated/xarray.Dataset.reset_coords.html\">https://xarray.pydata.org/en/stable/generated/xarray.Dataset.reset_coords.html</a> method on both dataset and datarray objects.   </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">ds</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span>\n<span class=\"o\">&lt;</span><span class=\"n\">xarray</span><span class=\"o\">.</span><span class=\"n\">Dataset</span><span class=\"o\">&gt;</span>\n<span class=\"n\">Dimensions</span><span class=\"p\">:</span>  <span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">:</span> <span class=\"mi\">36</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"mi\">275</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">:</span> <span class=\"mi\">205</span><span class=\"p\">)</span>\n<span class=\"n\">Coordinates</span><span class=\"p\">:</span>\n  <span class=\"o\">*</span> <span class=\"n\">time</span>     <span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">)</span> <span class=\"nb\">object</span> <span class=\"mi\">1980</span><span class=\"o\">-</span><span class=\"mi\">09</span><span class=\"o\">-</span><span class=\"mi\">16</span> <span class=\"mi\">12</span><span class=\"p\">:</span><span class=\"mi\">00</span><span class=\"p\">:</span><span class=\"mi\">00</span> <span class=\"o\">...</span> <span class=\"mi\">1983</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">17</span> <span class=\"mi\">00</span><span class=\"p\">:</span><span class=\"mi\">00</span><span class=\"p\">:</span><span class=\"mi\">00</span>\n    <span class=\"n\">xc</span>       <span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">float64</span> <span class=\"o\">...</span>\n    <span class=\"n\">yc</span>       <span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">float64</span> <span class=\"o\">...</span>\n<span class=\"n\">Dimensions</span> <span class=\"n\">without</span> <span class=\"n\">coordinates</span><span class=\"p\">:</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span>\n<span class=\"n\">Data</span> <span class=\"n\">variables</span><span class=\"p\">:</span>\n    <span class=\"n\">Tair</span>     <span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">float64</span> <span class=\"o\">...</span>\n</pre></div>\n\n\n<p>Invoking this method on a <strong>non-dimension coordinate</strong> (those without the <code>*</code>) works: </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">10</span><span class=\"p\">]:</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">reset_coords</span><span class=\"p\">([</span><span class=\"s2\">&quot;xc&quot;</span><span class=\"p\">])</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">10</span><span class=\"p\">]:</span>\n<span class=\"o\">&lt;</span><span class=\"n\">xarray</span><span class=\"o\">.</span><span class=\"n\">Dataset</span><span class=\"o\">&gt;</span>\n<span class=\"n\">Dimensions</span><span class=\"p\">:</span>  <span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">:</span> <span class=\"mi\">36</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">:</span> <span class=\"mi\">275</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">:</span> <span class=\"mi\">205</span><span class=\"p\">)</span>\n<span class=\"n\">Coordinates</span><span class=\"p\">:</span>\n  <span class=\"o\">*</span> <span class=\"n\">time</span>     <span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">)</span> <span class=\"nb\">object</span> <span class=\"mi\">1980</span><span class=\"o\">-</span><span class=\"mi\">09</span><span class=\"o\">-</span><span class=\"mi\">16</span> <span class=\"mi\">12</span><span class=\"p\">:</span><span class=\"mi\">00</span><span class=\"p\">:</span><span class=\"mi\">00</span> <span class=\"o\">...</span> <span class=\"mi\">1983</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">17</span> <span class=\"mi\">00</span><span class=\"p\">:</span><span class=\"mi\">00</span><span class=\"p\">:</span><span class=\"mi\">00</span>\n    <span class=\"n\">yc</span>       <span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">float64</span> <span class=\"o\">...</span>\n<span class=\"n\">Dimensions</span> <span class=\"n\">without</span> <span class=\"n\">coordinates</span><span class=\"p\">:</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span>\n<span class=\"n\">Data</span> <span class=\"n\">variables</span><span class=\"p\">:</span>\n    <span class=\"n\">Tair</span>     <span class=\"p\">(</span><span class=\"n\">time</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">float64</span> <span class=\"o\">...</span>\n    <span class=\"n\">xc</span>       <span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"n\">float64</span> <span class=\"o\">...</span>\n</pre></div>\n\n\n<p>However, if your coordinate is <strong>a dimension coordinate</strong>, xarray doesn't allow resetting this coordinate to a regular variable: </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">11</span><span class=\"p\">]:</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">reset_coords</span><span class=\"p\">([</span><span class=\"s2\">&quot;time&quot;</span><span class=\"p\">])</span>\n<span class=\"o\">---------------------------------------------------------------------------</span>\n<span class=\"ne\">ValueError</span>                                <span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">)</span>\n<span class=\"o\">&lt;</span><span class=\"n\">ipython</span><span class=\"o\">-</span><span class=\"nb\">input</span><span class=\"o\">-</span><span class=\"mi\">11</span><span class=\"o\">-</span><span class=\"mi\">53667</span><span class=\"n\">df9faf0</span><span class=\"o\">&gt;</span> <span class=\"ow\">in</span> <span class=\"o\">&lt;</span><span class=\"n\">module</span><span class=\"o\">&gt;</span>\n<span class=\"o\">----&gt;</span> <span class=\"mi\">1</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">reset_coords</span><span class=\"p\">([</span><span class=\"s2\">&quot;time&quot;</span><span class=\"p\">])</span>\n\n<span class=\"o\">~/</span><span class=\"n\">opt</span><span class=\"o\">/</span><span class=\"n\">miniconda</span><span class=\"o\">/</span><span class=\"n\">envs</span><span class=\"o\">/</span><span class=\"n\">playground</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">python3</span><span class=\"o\">.</span><span class=\"mi\">9</span><span class=\"o\">/</span><span class=\"n\">site</span><span class=\"o\">-</span><span class=\"n\">packages</span><span class=\"o\">/</span><span class=\"n\">xarray</span><span class=\"o\">/</span><span class=\"n\">core</span><span class=\"o\">/</span><span class=\"n\">dataset</span><span class=\"o\">.</span><span class=\"n\">py</span> <span class=\"ow\">in</span> <span class=\"n\">reset_coords</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">names</span><span class=\"p\">,</span> <span class=\"n\">drop</span><span class=\"p\">)</span>\n   <span class=\"mi\">1586</span>             <span class=\"n\">bad_coords</span> <span class=\"o\">=</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">names</span><span class=\"p\">)</span> <span class=\"o\">&amp;</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">dims</span><span class=\"p\">)</span>\n   <span class=\"mi\">1587</span>             <span class=\"k\">if</span> <span class=\"n\">bad_coords</span><span class=\"p\">:</span>\n<span class=\"o\">-&gt;</span> <span class=\"mi\">1588</span>                 <span class=\"k\">raise</span> <span class=\"ne\">ValueError</span><span class=\"p\">(</span>\n   <span class=\"mi\">1589</span>                     <span class=\"s2\">&quot;cannot remove index coordinates with reset_coords: </span><span class=\"si\">%s</span><span class=\"s2\">&quot;</span> <span class=\"o\">%</span> <span class=\"n\">bad_coords</span>\n   <span class=\"mi\">1590</span>                 <span class=\"p\">)</span>\n\n<span class=\"ne\">ValueError</span><span class=\"p\">:</span> <span class=\"n\">cannot</span> <span class=\"n\">remove</span> <span class=\"n\">index</span> <span class=\"n\">coordinates</span> <span class=\"k\">with</span> <span class=\"n\">reset_coords</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;time&#39;</span><span class=\"p\">}</span>\n</pre></div>",
        "id": 27216,
        "sender_full_name": "Anderson Banihirwe",
        "timestamp": 1616091692
    },
    {
        "content": "<p>I'm curious... what do you hope to accomplish once you've set the <code>time</code> coordinate to a regular variable?</p>",
        "id": 27217,
        "sender_full_name": "Anderson Banihirwe",
        "timestamp": 1616092168
    },
    {
        "content": "<p>Thanks!  That worked. This is for the SMYLE-analysis repo, for which there is a need for initialized prediction Datasets that are dimensioned as follows: (Y,L,M,...) where Y is start time, L is lead time, and M is ensemble member. It's useful to have the original \"time\" coordinate converted to a data variable that acquires dimensions (Y,L). You can have a look after I upload the finished notebook.</p>",
        "id": 27219,
        "sender_full_name": "Stephen Yeager",
        "timestamp": 1616093102
    },
    {
        "content": "<p>I think we prototyped an intake-esm approach to reading DPLE datasets</p>",
        "id": 27220,
        "sender_full_name": "Matt Long",
        "timestamp": 1616093270
    },
    {
        "content": "<p>One place to check these kinds of questions: <a href=\"https://xarray.pydata.org/en/latest/howdoi.html\" target=\"_blank\" title=\"https://xarray.pydata.org/en/latest/howdoi.html\">https://xarray.pydata.org/en/latest/howdoi.html</a></p>",
        "id": 27225,
        "sender_full_name": "Deepak Cherian",
        "timestamp": 1616094158
    },
    {
        "content": "<blockquote>\n<p>I think we prototyped an intake-esm approach to reading DPLE datasets</p>\n</blockquote>\n<p>This will be good to revisit for SMYLE-analysis. For now, I'm finding it helpful to learn how to do the necessary data manipulations.</p>",
        "id": 27243,
        "sender_full_name": "Stephen Yeager",
        "timestamp": 1616102742
    }
]