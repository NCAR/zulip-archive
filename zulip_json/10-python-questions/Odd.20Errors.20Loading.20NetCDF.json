[
    {
        "content": "<p>Hey there everyone!<br>\nI am currently trying to open some data from the anemometer on top of the ML. For a very rough outline of what the data looks like, the data from 1996 until 2020 is in .cdf formatting and from 2020 to present is in .nc. In order to open these files I am using xarray.open_mfdataset but am running into an issue. It seems to run fine when I only read in the .nc datafiles but when I try to read in the .cdf files it gives me an error that seems to be saying that the function is not installed. I've included some screenshots in case they help.<br>\n<a href=\"/user_uploads/2/6a/29D0e0LdoEZbB3IYTFzXfjPz/Screen-Shot-2021-11-11-at-2.53.41-PM.png\">Screen-Shot-2021-11-11-at-2.53.41-PM.png</a> <br>\n<a href=\"/user_uploads/2/fc/IuRmrNykZG8pPAxphd0EKMMi/Screen-Shot-2021-11-11-at-2.54.03-PM.png\">Screen-Shot-2021-11-11-at-2.54.03-PM.png</a> </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/6a/29D0e0LdoEZbB3IYTFzXfjPz/Screen-Shot-2021-11-11-at-2.53.41-PM.png\" title=\"Screen-Shot-2021-11-11-at-2.53.41-PM.png\"><img src=\"/user_uploads/2/6a/29D0e0LdoEZbB3IYTFzXfjPz/Screen-Shot-2021-11-11-at-2.53.41-PM.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/fc/IuRmrNykZG8pPAxphd0EKMMi/Screen-Shot-2021-11-11-at-2.54.03-PM.png\" title=\"Screen-Shot-2021-11-11-at-2.54.03-PM.png\"><img src=\"/user_uploads/2/fc/IuRmrNykZG8pPAxphd0EKMMi/Screen-Shot-2021-11-11-at-2.54.03-PM.png\"></a></div><p>Seems like a very odd situation to me so I appreciate any thoughts that anyone has (and let me know if you have any questions for me)! Thank you!</p>",
        "id": 46858,
        "sender_full_name": "Brendan Myers",
        "timestamp": 1636667837
    },
    {
        "content": "<p>You can specify <code>engine='netcdf4'</code> here within the <code>open_mfdataset</code> lines. Also, the times with the cdf files require a bit more pre-processing.  You can use a preprocess function such as the following</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"k\">def</span> <span class=\"nf\">fix_times</span><span class=\"p\">(</span><span class=\"n\">ds</span><span class=\"p\">):</span>\n    <span class=\"n\">new_time</span> <span class=\"o\">=</span> <span class=\"n\">cftime</span><span class=\"o\">.</span><span class=\"n\">num2date</span><span class=\"p\">(</span><span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">base_time</span> <span class=\"o\">+</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">time_offset</span><span class=\"p\">,</span> <span class=\"n\">units</span><span class=\"o\">=</span><span class=\"s1\">'seconds since 1970-01-01'</span><span class=\"p\">)</span>\n    <span class=\"n\">ds</span><span class=\"p\">[</span><span class=\"s1\">'time'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">new_time</span>\n    <span class=\"n\">ds</span><span class=\"p\">[</span><span class=\"s1\">'time'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">indexes</span><span class=\"p\">[</span><span class=\"s1\">'time'</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">to_datetimeindex</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">drop</span><span class=\"p\">([</span><span class=\"s1\">'base_time'</span><span class=\"p\">,</span> <span class=\"s1\">'samp_secs'</span><span class=\"p\">])</span>\n</code></pre></div>\n<p>you can pass this into the <code>open_mfdataset</code> line for the <code>.cdf</code> files</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">ds</span> <span class=\"o\">=</span> <span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">open_mfdataset</span><span class=\"p\">(</span><span class=\"s1\">'path/*.cdf'</span><span class=\"p\">,</span> <span class=\"n\">concat_dim</span><span class=\"o\">=</span><span class=\"s1\">'time'</span><span class=\"p\">,</span> <span class=\"n\">preprocess</span><span class=\"o\">=</span><span class=\"n\">fix_times</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>then, you call plot  as shown below</p>\n<p><a href=\"/user_uploads/2/81/ax5_PivVoTK-ch2VCWH9nfkR/Screen-Shot-2021-11-11-at-3.34.11-PM.png\">Screen-Shot-2021-11-11-at-3.34.11-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/81/ax5_PivVoTK-ch2VCWH9nfkR/Screen-Shot-2021-11-11-at-3.34.11-PM.png\" title=\"Screen-Shot-2021-11-11-at-3.34.11-PM.png\"><img src=\"/user_uploads/2/81/ax5_PivVoTK-ch2VCWH9nfkR/Screen-Shot-2021-11-11-at-3.34.11-PM.png\"></a></div>",
        "id": 46860,
        "sender_full_name": "Max Grover",
        "timestamp": 1636670130
    },
    {
        "content": "<p>Wow thanks for the quick reply and for all the help! I definitely would not have figured that one out on my own so thank you very much Max!</p>",
        "id": 46861,
        "sender_full_name": "Brendan Myers",
        "timestamp": 1636670766
    },
    {
        "content": "<p>Max, I'm not sure if I implemented something wrong, but I am getting a different error now... Will you look it over really quickly and make sure I didn't mistype something? It looks reasonable to me...<br>\n<a href=\"/user_uploads/2/89/AdSSSe5qDlKHAm3O6FEDpaVI/Screen-Shot-2021-11-11-at-4.07.10-PM.png\">Screen-Shot-2021-11-11-at-4.07.10-PM.png</a><br>\n<a href=\"/user_uploads/2/71/Gnh9BWy9OFzieOTKXvnN7wJY/Screen-Shot-2021-11-11-at-4.08.57-PM.png\">Screen-Shot-2021-11-11-at-4.08.57-PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/2/89/AdSSSe5qDlKHAm3O6FEDpaVI/Screen-Shot-2021-11-11-at-4.07.10-PM.png\" title=\"Screen-Shot-2021-11-11-at-4.07.10-PM.png\"><img src=\"/user_uploads/2/89/AdSSSe5qDlKHAm3O6FEDpaVI/Screen-Shot-2021-11-11-at-4.07.10-PM.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/2/71/Gnh9BWy9OFzieOTKXvnN7wJY/Screen-Shot-2021-11-11-at-4.08.57-PM.png\" title=\"Screen-Shot-2021-11-11-at-4.08.57-PM.png\"><img src=\"/user_uploads/2/71/Gnh9BWy9OFzieOTKXvnN7wJY/Screen-Shot-2021-11-11-at-4.08.57-PM.png\"></a></div>",
        "id": 46863,
        "sender_full_name": "Brendan Myers",
        "timestamp": 1636672325
    },
    {
        "content": "<p>Here is a written up example with some interactive plots <span class=\"user-mention\" data-user-id=\"193\">@Brendan Myers</span> ! Thanks for bringing up this question! <a href=\"https://ncar.github.io/esds/posts/2021/weather-station-data-preprocess/\">https://ncar.github.io/esds/posts/2021/weather-station-data-preprocess/</a></p>",
        "id": 46991,
        "sender_full_name": "Max Grover",
        "timestamp": 1636758225
    }
]