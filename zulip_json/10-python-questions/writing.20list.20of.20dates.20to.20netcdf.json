[
    {
        "content": "<p>Hello, I also have something with non-standard calendars that I have been struggling with.  I want to output the following list of dates to netcdf.  It's for a piControl so the years start at 1.</p>\n<p>[array(cftime.DatetimeNoLeap(4, 2, 2, 0, 0, 0, 0), dtype=object), array(cftime.DatetimeNoLeap(8, 2, 10, 0, 0, 0, 0), dtype=object), array(cftime.DatetimeNoLeap(9, 4, 2, 0, 0, 0, 0), dtype=object)]</p>\n<p>I have tried:<br>\n(1) Convert this list to an xarray data array and then use \"to_netcdf\": this gives unable to infer dtype on variable 'sswdate'; xarray cannot serialize arbitrary Python objects</p>\n<p>(2) Tried to convert to a datetimeindex instead.</p>\n<ul>\n<li>(a) pd.to_datetime(datelist): this gives &lt;class 'numpy.ndarray'&gt; is not convertible to datetime</li>\n<li>(b)  datelist.indexes.to_datetimeindex(): this gives  'list' object has no attribute 'indexes'</li>\n</ul>\n<p>Can anyone advise me as to how best to deal with this list of dates and get them into a netcdf file?  Converting to the datetimeindex is what I've done for similar problems before, but I guess something is missing here.</p>\n<p>Thanks for your help,<br>\nIsla</p>",
        "id": 39439,
        "sender_full_name": "Isla Simpson",
        "timestamp": 1628557255
    },
    {
        "content": "<p>Hi Isla,</p>\n<p>The weird thing about your list is it is a list of  <em>array</em> of cftime objects. That ends up confusing the software</p>\n<p>Your 2b solution assumes <code>datelist</code> is an xarray thing (which does have an <code>indexes</code> property). But <code>datelist</code> is a list so that's the reason for the error</p>\n<p>Here I pull out each individual item from the array and things work</p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"kn\">import</span> <span class=\"nn\">cftime</span>\n<span class=\"kn\">from</span> <span class=\"nn\">numpy</span> <span class=\"kn\">import</span> <span class=\"n\">array</span>\n\n<span class=\"n\">time</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">cftime</span><span class=\"o\">.</span><span class=\"n\">DatetimeNoLeap</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">object</span><span class=\"p\">),</span>\n    <span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">cftime</span><span class=\"o\">.</span><span class=\"n\">DatetimeNoLeap</span><span class=\"p\">(</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">object</span><span class=\"p\">),</span>\n    <span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">cftime</span><span class=\"o\">.</span><span class=\"n\">DatetimeNoLeap</span><span class=\"p\">(</span><span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">object</span><span class=\"p\">),</span>\n<span class=\"p\">]</span>\n<span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">DataArray</span><span class=\"p\">([</span><span class=\"n\">t</span><span class=\"o\">.</span><span class=\"n\">item</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">t</span> <span class=\"ow\">in</span> <span class=\"n\">time</span><span class=\"p\">],</span> <span class=\"n\">dims</span><span class=\"o\">=</span><span class=\"s2\">\"time\"</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">to_netcdf</span><span class=\"p\">(</span><span class=\"s2\">\"time.nc\"</span><span class=\"p\">)</span>\n</code></pre></div>",
        "id": 39440,
        "sender_full_name": "Deepak Cherian",
        "timestamp": 1628557764
    },
    {
        "content": "<p>Wow, thanks for the fast response!  Indeed, that has done the trick.  Thanks a lot!</p>",
        "id": 39441,
        "sender_full_name": "Isla Simpson",
        "timestamp": 1628558208
    }
]