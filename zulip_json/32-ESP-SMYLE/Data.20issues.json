[
    {
        "content": "<p>While building a catalog for the SYMLE output, I found a few problematic/corrupted files. I was wondering whether <strong>there is an established process</strong> for reporting data issues? </p>\n<p>Here's a list of some corrupted files: </p>\n<ul>\n<li>/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.1973-11.002/ocn/proc/tseries/month_1/b.e21.BSMYLE.f09_g17.1973-11.002.pop.h.UISOP.197311-197510.nc</li>\n<li>/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.1972-11.008/ocn/proc/tseries/month_1/b.e21.BSMYLE.f09_g17.1972-11.008.pop.h.VISOP.197211-197410.nc</li>\n<li>/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.1972-11.007/atm/proc/tseries/hour_6/b.e21.BSMYLE.f09_g17.1972-11.007.cam.h2.PSL.1972110100-1974103100.nc</li>\n<li>/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.1972-11.007/ocn/proc/tseries/month_1/b.e21.BSMYLE.f09_g17.1972-11.007.pop.h.J_DIC.197211-197410.nc</li>\n<li>/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.1972-11.009/ocn/proc/tseries/month_1/b.e21.BSMYLE.f09_g17.1972-11.009.pop.h.DIA_IMPVF_SALT.197211-197410.nc</li>\n</ul>\n<p>For instance: </p>\n<div class=\"codehilite\"><pre><span></span>$ ncdump -h /glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.1972-11.007/ocn/proc/tseries/month_1/b.e21.BSMYLE.f09_g17.1972-11.007.pop.h.J_DIC.197211-197410.nc\n</pre></div>\n\n\n<p>results in </p>\n<div class=\"codehilite\"><pre><span></span>NetCDF: Unknown file format\n</pre></div>",
        "id": 30141,
        "sender_full_name": "Anderson Banihirwe",
        "timestamp": 1619130589
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"13\">@Anderson Banihirwe</span> Thanks for this info. There is no established process, but this is a good venue for reporting issues. I'll email Nan &amp; Gary.</p>",
        "id": 30143,
        "sender_full_name": "Stephen Yeager",
        "timestamp": 1619132323
    },
    {
        "content": "<p>Sounds good... </p>\n<hr>\n<p>Not sure if this was intentional or not, but <strong>time units</strong> for most files under the <code>glc</code> component appear to be invalid ( as far as cftime and xarray are concerned). </p>\n<p>Here's the error from xarray: </p>\n<div class=\"codehilite\"><pre><span></span><span class=\"ne\">ValueError</span><span class=\"p\">:</span> <span class=\"n\">unable</span> <span class=\"n\">to</span> <span class=\"n\">decode</span> <span class=\"n\">time</span> <span class=\"n\">units</span> <span class=\"s1\">&#39;common_year since 0000-01-01 0:0:0&#39;</span> <span class=\"k\">with</span> <span class=\"s2\">&quot;calendar &#39;noleap&#39;&quot;</span><span class=\"o\">.</span> <span class=\"n\">Try</span> <span class=\"n\">opening</span> <span class=\"n\">your</span> <span class=\"n\">dataset</span> <span class=\"k\">with</span> <span class=\"n\">decode_times</span><span class=\"o\">=</span><span class=\"kc\">False</span> <span class=\"ow\">or</span> <span class=\"n\">installing</span> <span class=\"n\">cftime</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"n\">installed</span><span class=\"o\">.</span>\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>$ ncdump -h /glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.2000-11.015/glc/proc/tseries/year_1/b.e21.BSMYLE.f09_g17.2000-11.015.cism.h.artm.2001-2002.nc\nnetcdf b.e21.BSMYLE.f09_g17.2000-11.015.cism.h.artm.2001-2002 <span class=\"o\">{</span>\ndimensions:\n        <span class=\"nb\">time</span> <span class=\"o\">=</span> UNLIMITED <span class=\"p\">;</span> // <span class=\"o\">(</span><span class=\"m\">2</span> currently<span class=\"o\">)</span>\n        <span class=\"nv\">level</span> <span class=\"o\">=</span> <span class=\"m\">11</span> <span class=\"p\">;</span>\n        <span class=\"nv\">lithoz</span> <span class=\"o\">=</span> <span class=\"m\">20</span> <span class=\"p\">;</span>\n        <span class=\"nv\">staglevel</span> <span class=\"o\">=</span> <span class=\"m\">10</span> <span class=\"p\">;</span>\n        <span class=\"nv\">stagwbndlevel</span> <span class=\"o\">=</span> <span class=\"m\">12</span> <span class=\"p\">;</span>\n        <span class=\"nv\">x0</span> <span class=\"o\">=</span> <span class=\"m\">415</span> <span class=\"p\">;</span>\n        <span class=\"nv\">x1</span> <span class=\"o\">=</span> <span class=\"m\">416</span> <span class=\"p\">;</span>\n        <span class=\"nv\">y0</span> <span class=\"o\">=</span> <span class=\"m\">703</span> <span class=\"p\">;</span>\n        <span class=\"nv\">y1</span> <span class=\"o\">=</span> <span class=\"m\">704</span> <span class=\"p\">;</span>\n\n....\n\n  double time<span class=\"o\">(</span><span class=\"nb\">time</span><span class=\"o\">)</span> <span class=\"p\">;</span>\n                time:long_name <span class=\"o\">=</span> <span class=\"s2\">&quot;Model time&quot;</span> <span class=\"p\">;</span>\n                time:standard_name <span class=\"o\">=</span> <span class=\"s2\">&quot;time&quot;</span> <span class=\"p\">;</span>\n                time:units <span class=\"o\">=</span> <span class=\"s2\">&quot;common_year since 0000-01-01 0:0:0&quot;</span> <span class=\"p\">;</span>\n                time:calendar <span class=\"o\">=</span> <span class=\"s2\">&quot;noleap&quot;</span> <span class=\"p\">;</span>\n</pre></div>",
        "id": 30146,
        "sender_full_name": "Anderson Banihirwe",
        "timestamp": 1619133333
    },
    {
        "content": "<p>Steve.  The original data from these runs no longer exist.  These runs will need to be recreated to replace these files.</p>",
        "id": 30147,
        "sender_full_name": "Nan Rosenbloom",
        "timestamp": 1619135260
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"13\">@Anderson Banihirwe</span>   I don't think this is intentional; but I just checked the CMIP6 timeseries and I see the same time dimensionality:  <br>\n/glade/campaign/collections/cmip/CMIP6/timeseries-cmip6/b.e21.B1850cmip6.f09_g17.DAMIP-hist-sol.002/glc/proc/tseries/year_1/b.e21.B1850cmip6.f09_g17.DAMIP-hist-sol.002.cism.h.artm.1851-1900.nc</p>",
        "id": 30148,
        "sender_full_name": "Nan Rosenbloom",
        "timestamp": 1619135493
    },
    {
        "content": "<blockquote>\n<p>Not sure if this was intentional or not, but time units for most files under the glc component appear to be invalid ( as far as cftime and xarray are concerned).</p>\n</blockquote>\n<p>For anyone who runs into this calendar issue when decoding time with  units: <code>'common_year since 0000-01-01 0:0:0'</code>, this issue has been resolved in <code>cftime v1.5.1</code></p>\n<div class=\"codehilite\" data-code-language=\"Python\"><pre><span></span><code><span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]:</span> <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"s2\">\"/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.2000-11.015/glc/proc/tseries/year_1/b.e21.BSMYLE.f09_g17.2000-11.015.cism.h.artm.2001-2002.nc\"</span>\n\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]:</span> <span class=\"n\">ds</span> <span class=\"o\">=</span> <span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">open_dataset</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"p\">,</span> <span class=\"n\">use_cftime</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">chunks</span><span class=\"o\">=</span><span class=\"p\">{})</span>\n\n<span class=\"n\">In</span> <span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]:</span> <span class=\"n\">ds</span><span class=\"o\">.</span><span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">encoding</span>\n<span class=\"n\">Out</span><span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]:</span>\n<span class=\"p\">{</span><span class=\"s1\">'zlib'</span><span class=\"p\">:</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n <span class=\"s1\">'shuffle'</span><span class=\"p\">:</span> <span class=\"kc\">True</span><span class=\"p\">,</span>\n <span class=\"s1\">'complevel'</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n <span class=\"s1\">'fletcher32'</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">,</span>\n <span class=\"s1\">'contiguous'</span><span class=\"p\">:</span> <span class=\"kc\">False</span><span class=\"p\">,</span>\n <span class=\"s1\">'chunksizes'</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"mi\">512</span><span class=\"p\">,),</span>\n <span class=\"s1\">'source'</span><span class=\"p\">:</span> <span class=\"s1\">'/glade/campaign/cesm/development/espwg/SMYLE/archive/b.e21.BSMYLE.f09_g17.2000-11.015/glc/proc/tseries/year_1/b.e21.BSMYLE.f09_g17.2000-11.015.cism.h.artm.2001-2002.nc'</span><span class=\"p\">,</span>\n <span class=\"s1\">'original_shape'</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,),</span>\n <span class=\"s1\">'dtype'</span><span class=\"p\">:</span> <span class=\"n\">dtype</span><span class=\"p\">(</span><span class=\"s1\">'float64'</span><span class=\"p\">),</span>\n <span class=\"s1\">'units'</span><span class=\"p\">:</span> <span class=\"s1\">'common_year since 0000-01-01 0:0:0'</span><span class=\"p\">,</span>\n <span class=\"s1\">'calendar'</span><span class=\"p\">:</span> <span class=\"s1\">'noleap'</span><span class=\"p\">}</span>\n</code></pre></div>",
        "id": 44053,
        "sender_full_name": "Anderson Banihirwe",
        "timestamp": 1633033707
    }
]